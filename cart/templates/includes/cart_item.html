{% load cart_tools %}
{% load static %}


<tr>
    <td data-th="Item">
      <div class="row">
        <div class="col-md-3 text-left">
          {% if item.product.image.url %}    
          <img
          src="{{item.product.image.url}}"
          alt="product image"
          class="img-fluid d-none d-md-block rounded mb-2 border border-black-50"
          style="height: 100px;  width: 100px; object-fit: cover;"
        />
        {% else %}
        <img
        src="{% static 'images/award-placeholder.webp' %}"
        alt="product image"
        class="img-fluid d-none d-md-block rounded mb-2 bg-{{item.product.color}} border border-black-50"
        style="height: 100px;   width: 100px; object-fit: cover;"
      />
        {% endif %}
       
        </div>
        <div class="col-md-9 text-left mt-sm-2">
          <h4 class='cart-title'>{{item.product.name}}</h4>
          <p class="font-weight-light text-secondary d-none d-sm-block">
            {{item.product.description}}
          </p>
        </div>
      </div>
    </td>
    <td data-th="Price">
      {% if item.product.sale or item.product.discount %}
      <p class='text-decoration-line-through text-danger'>${{item.product.price}}</p>
      {% else %}
      <p>${{item.product.price}}</p>
      {% endif %}
      {% if item.product.sale %}<span class='badge bg-success'>%{{item.product.sale}} Sale</span> {% endif %}
      {% if request.user.is_authenticated %}
      {% if request.user.profile.subscription and item.product.discount != None %}
       <p class='badge bg-{{request.user.profile.subscription.color}} text-wrap'>
        <span class='membership-tag'>{{request.user.profile.subscription}}</span>
        <span>-${{item.product.discount|floatformat:2}}</span>
        </p> 
      {% endif %}
      {% endif %}
  
    </td>
    <td data-th="Quantity">
      {% if item.product.id < 26 %}
      <form
      class="form text-center"
      action="{% url 'update_cart' item.product.id %}"
    method="POST"
    >
      {% csrf_token %}
      <input
        type="number"
        name='quantity'
        class="form-control text-center"
        value="{{item.quantity}}"
      />
      <button type='submit' class="cart-button text-primary">
        Update
      </button>
      <input type="hidden" name="redirect_url" value="{{ request.path }}" />
    </form>
      {% endif %}
        <form
        class="form text-center"
        action="{% url 'remove_from_cart' item.product.id %}"
        method="POST"
        >
          {% csrf_token %}
          {% if item.product.id >= 26 %}
          <strong class="form-control bg-secondary text-center text-white fw-bold"
          >{{item.quantity}}</strong> 
          {% endif %}
          <button
            type="submit"
            class="cart-button text-danger"
          >
          Remove
          </button>
          <input type="hidden" name="redirect_url" value="{{ request.path }}" />
        </form>
    </td>
    <td data-th="Subtotal">
      ${{ item.product.total_final_price | calc_subtotal:item.quantity }}
    </td>
  </tr>
  
  
  